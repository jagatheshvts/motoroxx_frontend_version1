<div class="container my-3 p-4 rounded shadow" style="background-color: #f8f9fa; color: #000;">

    <div>
        <h2 class="text-center text-primary mb-4">Job Card</h2>
        <div class="toggle-slider">
            <input
              type="radio"
              id="mob"
              name="searchType"
              value="mobile"
              [(ngModel)]="searchType"
            />
            <label for="mob" class="toggle-option">Mob</label>
          
            <input
              type="radio"
              id="veh"
              name="searchType"
              value="vehicle"
              [(ngModel)]="searchType"
            />
            <label for="veh" class="toggle-option">Veh</label>
          
            <div class="slider-background"></div>
          </div>
          <div style="padding: 10px;">


          </div>

        <div class="row mb-4 d-flex justify-content-between align-items-center ">
            <!-- <div class="slider">
                <label>
                  <input
                    type="radio"
                    name="searchType"
                    value="mobile"
                    [(ngModel)]="searchType"
                  />
                  Mobile Number
                </label>
                <label>
                  <input
                    type="radio"
                    name="searchType"
                    value="vehicle"
                    [(ngModel)]="searchType"
                  />
                  Vehicle Number
                </label>
              </div> -->
             
              
            <div class="col-md-3 d-flex">

             


                <label  for="vehicle-details" class="form-label">Phone</label>
                <input *ngIf="searchType == 'mobile'" type="text" id="vehicle-details" class="form-control" placeholder="search by mobile number"
                    [(ngModel)]="jobcardobj.mobile" (input)="checkvehicles(vehiclehistorypage)" name="phone"
                    maxlength="10" />
                <input *ngIf="searchType == 'vehicle'" type="text" id="vehicle-details" class="form-control" placeholder="search by vehcile number"
                    [(ngModel)]="jobcardobj.mobile" (input)="checkvehicles(vehiclehistorypage)" name="phone"
                    maxlength="10" />
                <button class="btn btn-primary" (click)="clearall()" style="height: 30px;width: 100px;">Clear
                    all</button>
            </div>
            <div class="col-md-3 d-flex">
                <label for="vehicle-details" class="form-label" style="padding-right: 20px;">Name</label>
                <input type="text" id="vehicle-details" class="form-control  " placeholder="Enter the name"
                    [(ngModel)]="jobcardobj.name" />
            </div>

            <!-- <div class="col-md-3 d-flex">
                <label style="padding-right: 20px;">location</label>

                <input type="text" class="form-control" placeholder="Search Location" [(ngModel)]="location" />
                <button class="btn btn-primary dropdown-toggle" (click)="toggleLocationDropdown()"
                    style="height: 30px;width:20px;"></button>
                <ul *ngIf="showlocationdropdown" class="dropdown-menu show "
                    style="margin-left: 86px;margin-top: 35px;">
                    <li *ngFor="let option of locationOptions" class="dropdown-item" (click)="selectLocation(option)">
                        {{ option }}
                    </li>
                </ul>
            </div> -->


            <div class="col-md-3 d-flex">
                <label style="padding-right: 20px;">Location</label>

                <input type="text" class="form-control" placeholder="Search Location" [(ngModel)]="location"
                    (blur)="hidlocationDropdown()" />
                <button class="btn btn-primary dropdown-toggle" (click)="toggleLocationDropdown()"
                    (keydown)="handleDropdownKeydown($event)" style="height: 30px; width: 20px;"></button>
                <ul *ngIf="showlocationdropdown" class="dropdown-menu show"
                    style="margin-left: 86px; margin-top: 35px;">
                    <li *ngFor="let option of locationOptions; let i = index" class="dropdown-item"
                        [class.active]="i === activeIndex" (click)="selectLocation(option)">
                        {{ option }}
                    </li>
                </ul>
            </div>




            <div class="col-md-3 d-flex">
                <!-- <label style="padding-right: 20px;">location</label> -->

                <select id="color" style="background-color: #f8f9fa; " placeholder="Choose Colour"
                    class="form-select text-center" [(ngModel)]="advisor">
                    <option value="" disabled selected>Select Advisor</option>
                    <option *ngFor="let tech of technician" [value]="tech.superadmin_username">
                        {{ tech.superadmin_username }}
                    </option>
                </select>
            </div>
        </div>
        <div class="row-md-3 d-flex">
            <div class="col-md-1 d-flex flex-column gap-3">
                <label class="d-flex align-items-center">
                    <input class="form-check-input small-checkbox shadow-sm me-2" [(ngModel)]="isGSTChecked" type="checkbox"/>GST
                </label>
            </div>
            <div class="col-md-2 d-flex" *ngIf="isGSTChecked">
                <input type="text" id="vehicle-details" class="form-control" style="width: 100%;margin-left: -24px;" placeholder="Enter The GST Name"
                    [(ngModel)]="jobcardobj.gstname" />
            </div>
            <div class="col-md-3 d-flex" *ngIf="isGSTChecked">
                <input type="text" id="vehicle-details" style="width: 96%" class="form-control" placeholder="Enter The GST Number"
                    [(ngModel)]="jobcardobj.gstnumber" />
            </div>
        </div>
        
        <div style="padding: 10px;">

        </div>
        <div class="row mb-4 d-flex justify-content-center align-items-center">
            <div class="col-md-4 d-flex justify-content-center align-items-center">
                <div class="v1-cnt">
                    <label>Veh-No</label>
                    <input type="text" class="form-control text-center veh1" placeholder="TN" maxlength="2"
                        [(ngModel)]="vehiclenumber.vehicleState" />
                    <input type="text" class="form-control text-center veh1" placeholder="0 0"
                        [(ngModel)]="vehiclenumber.vehicleDistrict" name="phone" maxlength="2" />
                    <input type="text" class="form-control text-center veh1" placeholder="XY" maxlength="3"
                        [(ngModel)]="vehiclenumber.vehicleCity" />
                    <input type="text" class="form-control text-center l-v1" placeholder="0 0 0 0" name="phone"
                        maxlength="4" [(ngModel)]="vehiclenumber.vehicleNumber" />
                </div>
            </div>

            <!-- <div class="col-md-2   gap-2 ">
                <input type="text" class="form-control" placeholder="Search Brand" [(ngModel)]="selectedBrandName"
                    (focus)="showDropdown = true" (blur)="hidebrandDropdown()" />
                <ul *ngIf="showDropdown" class="dropdown-menu show ">
                    <li *ngFor="let brand of branddata" class="dropdown-item" (click)="selectBrand(brand)">
                        {{brand}}
                    </li>
                </ul>
            </div> -->


            <div class="col-md-2 gap-2">
                <input type="text" class="form-control" placeholder="Search Brand" [(ngModel)]="selectedBrandName"
                    (focus)="showDropdown = true" (blur)="hidebrandDropdown()" (keydown)="onKeyDown($event)" />
                <ul *ngIf="showDropdown" class="dropdown-menu show custom-dropdown">
                    <li *ngFor="let brand of branddata; let i = index" #brandItem [ngClass]="{'active': i === selectedIndex}"
                        class="dropdown-item" (click)="selectBrand(brand)">
                        {{ brand }}
                    </li>
                </ul>
            </div>





            <!-- <div class="col-md-2 gap-2">
                <input type="text" class="form-control" placeholder="Search Model" [(ngModel)]="selectedmodelname"
                    (focus)="showmodelDropdown = true" (blur)="hidemodelDropdown()" />
                <ul *ngIf="showmodelDropdown" class="dropdown-menu show custom-dropdown">
                    <li *ngFor="let model of seletedbrand_model" class="dropdown-item" (click)="selectmodel(model)">
                        {{ model.bikename }}
                    </li>
                    <button class="btn btn-primary" (click)="openmodelpopup(modelpage)">add New</button>
                </ul>
            </div> -->

            <div class="col-md-2 gap-2">
                <input type="text" class="form-control" placeholder="Search Model" [(ngModel)]="selectedmodelname"
                    (focus)="showmodelDropdown = true" (blur)="hidemodelDropdown()"
                    (keydown)="onModelKeyDown($event)" />
                <ul *ngIf="showmodelDropdown" class="dropdown-menu show custom-dropdown">
                    <li *ngFor="let model of seletedbrand_model; let i = index" #modelItem
                        [ngClass]="{'active': i === selectedModelIndex}" class="dropdown-item"
                        (click)="selectmodel(model)">
                        {{ model.bikename }}
                    </li>
                    <button class="btn btn-primary" (click)="openmodelpopup(modelpage)">Add New</button>
                </ul>
            </div>

        



            <div class="col-md-2 gap-2">
                <select id="color" placeholder="Choose Colour" class="form-select  text-center"
                    [(ngModel)]="modelcolor" >
                    <option value="" disabled selected>Select Colour</option>
                    <option *ngFor="let color of listColors">{{color}}</option>
                    <!-- <option value="add" >Add Color</option> -->
                </select>
                
                
            </div>

            <div class="col-md-2">
                <button class="btn btn-primary" (click)="updatevehcilecolor(vehcilecolorpage)">Add Color</button>
            </div>
        </div>


        <div class="row mb-4 d-flex  ">
            <div class="col-md-3 d-flex flex-column gap-3">
                <label>
                    <input class="form-check-input small-checkbox shadow-sm mr-4 " type="checkbox"
                        [(ngModel)]="odoMeter" (keydown.enter)="toggleOdoMeter()" /> Odometer not working
                </label>
                <input type="text" placeholder="Enter the Odometer " [disabled]="odoMeter"
                    class="form-control  text-center" [(ngModel)]="odometerreading" />
            </div>

            <div class="col-md-3 d-flex flex-column gap-2" style="padding-bottom: 25px;">
                <label for="fuelSlider">Fuel level: {{ fuelAmount.toFixed(2) }}</label>
                <input type="range" id="volume" name="volume" min="0" max="100" (input)="updateFuelAmount($event)" />
                <label class="d-flex justify-content-between w-100 position-relative">
                    <span class="position-absolute text-dark" style="left: 0;">E</span>
                    <span class="position-absolute text-dark" style="left: 25%;">1/4</span>
                    <span class="position-absolute text-dark" style="left: 50%;">1/2</span>
                    <span class="position-absolute text-dark" style="left: 75%;">3/4</span>
                    <span class="position-absolute text-dark" style="right: 0;">F</span>
                </label>
            </div>

            <div *ngIf="genralservice_boolean" class="col-md-3 d-flex align-items-center justify-content-center gap-3">
                <input class="form-check-input small-checkbox shadow-sm mr-4" type="checkbox" value="" id="vehicleCheck"
                    [(ngModel)]="generalService" (keydown.enter)="toggleGeneralService()">
                <label>General service</label>
            </div>
            <div class="col-md-3">
            </div>
        </div>

        <div class="row mb-3 d-flex align-items-center ">
            <div class="col-md-1">
                <label>
                    Complaints
                </label>
            </div>
            <div class="col-md-6 d-flex align-items-center gap-2">
                <input type="text" [(ngModel)]="newComplaint" class="form-control" placeholder="Enter Complaints" />
                <button class="btn border border-2 border-primary rounded-circle" (click)="addComplaint()"
                    style="width: 50px; height: 50px; border-width: 2px; font-weight: bold; display: flex; justify-content: center; align-items: center;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="blue" class="bi bi-plus"
                        viewBox="0 0 16 16">
                        <path
                            d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4" />
                    </svg>
                </button>
            </div>

            <div class="col-md-3 d-flex align-items-center gap-2">
                <mat-form-field class="custom-datepicker flex-grow-1 " appearance="outline" >
                    <mat-label>delivery date</mat-label>
                    <mat-date-range-input [formGroup]="range" [rangePicker]="picker">
                        <input matStartDate formControlName="start" placeholder="Start date" />
                        <input matEndDate formControlName="end" placeholder="End date" />
                    </mat-date-range-input>
                    <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                    <mat-date-range-picker #picker (closed)="onDateChange()"></mat-date-range-picker>
                    <mat-error *ngIf="range.controls.start.hasError('matStartDateInvalid')">
                        Invalid start date
                    </mat-error>
                    <mat-error *ngIf="range.controls.end.hasError('matEndDateInvalid')">
                        Invalid end date
                    </mat-error>
                </mat-form-field>
                <!-- Clear Dates button -->
                <!-- <button mat-button (click)="clearDateRange()" class="btn btn-outline-secondary">
                    Clear Dates
                </button> -->
            </div> 

            <div class="col-md-5">
            </div>
        </div>

        <div class="row mb-4 d-flex">

            <div class="col-md-4 ">
                <label>Added Complaints</label>

                <!-- orginal code for adding complaints start -->
                 
                <!-- <ul class="list-group" style="max-height: 200px; overflow-y: auto;">
                    <li *ngFor="let complaint of adddedComplaints; let i = index"
                        class="list-group-item d-flex justify-content-between align-items-center">
                        {{ complaint }}
                        <button class="btn btn-primary" (click)="removeComplaint(i)"
                            style="margin-right: 10px;background-color: rgb(88, 100, 255);">
                            <i class="bi bi-trash"></i>
                        </button>
                    </li>
                </ul> -->

                <!-- orginal code for adding complaints end -->




                <ul class="list-group" style="max-height: 200px; overflow-y: auto;">
                    <li *ngFor="let complaint of adddedComplaints; let i = index"
                        class="list-group-item d-flex justify-content-between align-items-center">
                        
                        <div *ngIf="editIndex !== i; else editMode">
                            {{ complaint }}
                        </div>
                
                        <ng-template #editMode>
                            <input type="text" [(ngModel)]="editComplaintText" class="form-control"/>
                        </ng-template>
                
                        <div class="d-flex gap-2">
                            <button *ngIf="editIndex !== i" class="btn btn-warning" (click)="editComplaint(i, complaint)">
                                <i class="bi bi-pencil"></i>
                            </button>
                            <button *ngIf="editIndex === i" class="btn btn-success" (click)="saveComplaint(i)">
                                <i class="bi bi-check"></i>
                            </button>
                            <button class="btn btn-primary" (click)="removeComplaint(i)">
                                <i class="bi bi-trash"></i>
                            </button>
                        </div>
                    </li>
                </ul>
                





            </div>
            <div class="col-md-5  align-items-center">
                <label>Remarks</label>
                <textarea id="remarks" class="form-control " [(ngModel)]="remarks"
                    placeholder="Enter your remarks here..."
                    style="flex: 1; text-align: left; height: 50px; resize: none;"></textarea>
            </div>
            <div *ngIf="editflag == 'edit'" class="col-md-3 d-flex align-items-center" style="padding-left: 100px;">
                <button type="button" class="btn btn-primary  btn-lg" (click)="updatejobcard()">Update</button>
            </div>
            <div *ngIf="editflag !== 'edit'" class="col-md-3 d-flex align-items-center" style="padding-left: 100px;">
                <button type="button" class="btn btn-primary  btn-lg" (click)="savejobcard()">Proceed</button>
            </div>
        </div>
    </div>
</div>




<ng-template #vehiclehistorypage>

   
    <div class="header">
        <p class="header-message">Vehicle Details Are Here.</p>
        <button type="button" class="btn-close top-right" aria-label="Close"
            (click)="vehiclehistorypopup_close()"></button>
    </div>


    <div class="modal-body">
        <h3 style="margin: 0;padding: 0;"><b>Vehicle details</b></h3>
        <h3 *ngIf="searchType == 'mobile'" style="margin: 0;padding: 0;"><b>{{ vehcilehistorydata?.[0]?.name }} / {{
                vehcilehistorydata?.[0]?.customer_vehicles?.mobile }} / {{
                vehcilehistorydata?.[0]?.address }}</b></h3>
        <h3 *ngIf="searchType == 'vehicle'" style="margin: 0;padding: 0;"><b>{{ vehcilehistorydata?.[0]?.name }} / {{
                vehcilehistorydata?.[0]?.address }}</b></h3>

        
        <!-- pavithra ui start -->

        <button id="rightButton"
            (click)="toggleHistoricalSidebar(vehcilehistorydata?.[0]?.customer_vehicles?._id, vehcilehistorydata?.[0]?.customer_vehicles?.mobile )">Historical
            Data</button>
        <!-- pavithra ui end -->




        <b>
            <hr class="bold-line" style="margin: 0; padding: 0; color: black;">
        </b>

        <!-- pavithra history ui start second -->

        <div class="sidebar" [class.open]="isHistoricalSidebarOpen">
            <div class="styleforbutton">
                <button type="button" class="btn-close" aria-label="Close"
                    (click)="toggleHistoricalSidebar(vehicle_id)"></button>
            </div>
            <div class="d-flex">
                <div *ngFor="let data of vehcilehistorydata" style="padding-right: 30px;">
                    <div *ngIf="historicalobjectData == data.customer_vehicles._id">
                        <h3>{{data.customer_vehicles.vh_number}} / {{data.customer_vehicles.brand}}
                            {{data.customer_vehicles.model}}
                        </h3>
                    </div>
                    <div *ngFor="let record of historicalData">
                        <div>

                            <div *ngIf="record.vehicle_id == data.customer_vehicles._id">
                                <button (click)="detailsfortable(record.vehicle_id)" class="textStyle">
                                    {{ record.invoice_summary.ModifiedDate | date: 'dd MMM yyyy' }}<br>
                                    ₹{{ record.invoice_summary.netTotal }}</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <div *ngIf="isColumnVisible">
                <div class="container d-flex justify-content-start align-items-start"
                    style="width: 100%; max-width: 100%; padding: 15px;">
                    <div style="height: 340px; width: 100%; overflow-y: auto; border: 0px solid #ddd; padding: 10px;">
                        <table class="table table-bordered">
                            <thead>
                                <tr>
                                    <th style="margin: 0;padding: 8px;">No.</th>
                                    <th style="margin: 0;padding: 8px;">Item</th>
                                    <th style="margin: 0;padding: 8px;">Quantity</th>
                                    <th style="margin: 0;padding: 8px;">Rate</th>
                                    <th style="margin: 0;padding: 8px;">Total</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let data of mergedvalue; let i = index">
                                    <td style="margin: 0;padding: 8px;">{{ i + 1 }}</td>
                                    <td style="margin: 0;padding: 8px;">{{ data.partDescription }}</td>
                                    <td style="margin: 0;padding: 8px;">{{ data.qty }}</td>
                                    <td style="margin: 0;padding: 8px;">{{ data.rate }}</td>
                                    <td style="margin: 0;padding: 8px;">{{ data.total }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div><br>




                <div *ngFor="let data of vehcilehistorydata">
                    <div *ngFor="let record of historicalData">
                        <div>
                            <div *ngIf="record.vehicle_id == data.customer_vehicles._id"
                                style="text-align: right; margin-right: 20px;">
                                <p><b>
                                        Total Amount: ₹{{ record.invoice_summary.netTotal }}</b></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>



        <!-- pavithra history ui end second -->






        <div >
            <div *ngFor="let data of vehcilehistorydata">
                <h3 style="padding-top: 20px;">{{data.customer_vehicles.vh_number}} / {{data.customer_vehicles.brand}}
                    {{data.customer_vehicles.model}}
                    <button style="background: none; border: none; padding: 0; cursor: pointer;margin-left: 10px;"
                        (click)="onSelectVehicle(data.customer_vehicles._id)">
                        <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="blue"
                            class="bi bi-plus-circle" viewBox="0 0 16 16">
                            <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16" />
                            <path
                                d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4" />
                        </svg>
                    </button><br>


                    <div class="row g-3" style="padding-top: 8px;">
                        <div class="col-md-2" style="padding-top: 8px;"
                            *ngFor="let jobcard of data.customer_vehicles.jobcard_details ; let i = index ">
                            <div>
                                <div *ngIf="jobcard.invoice">
                                    <div *ngIf="jobcard.multipleinvoice">

                                        <button *ngIf="jobcard.multipleinvoice.length == 0" (click)="toggleSidebar(jobcard,data,i)" class="textStyle">
                                            <b>{{jobcard.booking_reference_id}}</b><br>
                                            {{ jobcard.invoice.date|date:'dd-MM-yyyy'}}<br>₹{{
                                            jobcard.invoice.invoice_amount }}</button>
    
                                        <button *ngIf="jobcard.multipleinvoice.length > 0" (click)="toggleSidebar_multipleinvoice(jobcard,data)" class="textStyle"><b>{{jobcard.booking_reference_id}}</b><br>{{ jobcard.invoice.date|date:'dd-MM-yyyy'}}<br>₹{{
                                            jobcard.invoice.invoice_amount }}</button>
                                    </div>
                                    <div *ngIf="!jobcard.multipleinvoice">
                                        <button (click)="toggleSidebar(jobcard,data,i)" class="textStyle">
                                            <b>{{jobcard.booking_reference_id}}</b><br>
                                            {{ jobcard.invoice.date|date:'dd-MM-yyyy'}}<br>₹{{
                                            jobcard.invoice.invoice_amount }}</button>

                                    </div>
                                </div>
                               
                                <div *ngIf="!jobcard.invoice && jobcard.estimate">
                                    <button (click)="toggleSidebar(jobcard,data,i)" class="textStyle"><b>{{jobcard.booking_reference_id}}</b><br>{{ jobcard.estimate.date |
                                        date:'dd-MM-yyyy'}}<br style="margin: 0;padding: 0;">₹{{
                                        jobcard.estimate.estimate_amount}}</button>

                                </div>

                                <div *ngIf="!jobcard.invoice && !jobcard.estimate ">
                                    <button (click)="toggleSidebar()" class="textStyle"><b>{{jobcard.booking_reference_id}}</b><br>NA</button>
                                </div>
                            </div>
                            <div class="sidebar" [class.open]="isSidebarOpen_multiinvoice">

                                <div class="styleforbutton">
                                    <button type="button" class="btn-close" aria-label="Close" (click)="isSidebarOpen_multiinvoice = false"></button>
                                </div>

                                <!-- <div *ngFor="let multipleinvoice of multiinvoicehistory_clicked ; let i = index " (click)="toggleSidebar_multipleinvoice_card(multipleinvoice,i)" >
                                    <div class="card" tabindex="0" >
                                      <div>
                                       <b>INV{{i+1}}-</b>{{multipleinvoice.date | date:'yyyy-MM-dd'}}
                                      </div>
                                        <div>
                                          {{multipleinvoice.invoice_amount}}
                                        </div>
                                    </div>
                                  </div> -->

                                  <div class="invoice-cards-container">
                                    <div *ngFor="let multipleinvoice of multiinvoicehistory_clicked; let i = index" 
                                         (click)="toggleSidebar_multipleinvoice_card(multipleinvoice, i)" (keydown.enter)="toggleSidebar_multipleinvoice_card(multipleinvoice, i)">
                                      <div class="card" tabindex="0">
                                        <div>
                                          <b>INV{{ i + 1 }}-</b>{{ multipleinvoice.date | date: 'yyyy-MM-dd' }}
                                        </div>
                                        <div>
                                          {{ multipleinvoice.invoice_amount }}
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                  

                                <p (click)="leftaerrow(i)" style="visibility: hidden;" >
                                    <svg   xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 100 100"
                                        class="btnforarrow">
                                        <circle cx="50" cy="50" r="45" stroke="blue" stroke-width="2" fill="none" />

                                        <path d="M60 35 L40 50 L60 65" stroke="blue" stroke-width="2" fill="none"
                                            stroke-linecap="round" stroke-linejoin="round" />
                                    </svg>
                                </p>

                                <p (click)="rightaerrow()" style="float:right;margin-top:-62px;visibility: hidden;">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50"
                                        viewBox="0 0 100 100">
                                        <circle cx="50" cy="50" r="45" stroke="blue" stroke-width="2" fill="none" />

                                        <path d="M40 35 L60 50 L40 65" stroke="blue" stroke-width="2" fill="none"
                                            stroke-linecap="round" stroke-linejoin="round" />
                                    </svg>
                                </p>

                             

                                <div class="main_container">
                                    <p style="margin: 0px;padding: 0px;font-size: 0.9rem;" *ngIf="carddata_fortable.length > 0"><b> {{
                                            vehicleNumberfor_slider }}/{{ bikebrandfor_slider }}/{{ bikemodelfor_slider
                                            }}</b>
                                    </p>
                                    <div class="invstyle" *ngIf="carddata_fortable.length > 0">
                                        
                                        <p><b>{{ invoiceNum }}/{{ invoiceDate | date:'dd MMM yyyy' }}</b></p>
                                        <div *ngIf="jobcard.invoice">
                                            <p><b>Inv Amount: ₹{{ invoiceAmount }}</b></p>
                                        </div>
                                        <div *ngIf="!jobcard.invoice && jobcard.estimate">
                                            <p><b>Est Amount: ₹{{ invoiceAmount }}</b></p>
                                        </div>
                                        <div *ngIf="!jobcard.invoice && !jobcard.estimate ">
                                            <p><b>Inv Amount: ₹{{ invoiceAmount }}</b></p>
                                        </div>

                                        
                                    </div>


                                    <div class="container">

                                        <div class="left">
                                            <h2 style="margin: 0;padding: 0;">Items:</h2>
                                            <div style="max-height: 173px; overflow-y: scroll; border: 1px solid #ccc; margin-top: 10px;">

                                                <table>
                                                    <thead>
                                                        <tr>
                                                            <th style="margin: 0;padding: 0;">S.NO</th>
                                                            <th style="margin: 0;padding: 0;">Description</th>
                                                            <th style="margin: 0;padding: 0;">Amount</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr *ngFor="let data of carddata_fortable ; let i = index ">
                                                            <td style="margin: 0;padding: 0; ">{{i+1}}</td>
                                                            <td style="margin: 0;padding: 0;">{{data.spare}}</td>
                                                            <td style="margin: 0;padding: 0; ">{{data.amount}}</td>
                                                        </tr>
    
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>

                                        <div class="right">
                                            <h2 style="margin: 0;padding: 0;">Complaints:</h2>


                                            <table>
                                                <thead>
                                                    <tr>
                                                        <th style="margin: 0;padding: 0;">S.NO</th>
                                                        <th style="margin: 0;padding: 0;">Description</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr *ngFor="let data of carddata_forcomplaints; let i = index">
                                                        <td style="margin: 0;padding: 0;">{{ i + 1 }}</td>
                                                        <td style="margin: 0;padding: 0;">
                                                            {{ getComplaint(data) }}
                                                        </td>
                                                    </tr>

                                                </tbody>
                                            </table>

                                            <h2 style="margin: 0;padding: 0;">Remarks:</h2>
                                            <div class="remarks">
                                                <p style="margin: 0;padding: 0;font-size: 0.9rem;">{{remarks}}</p>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>






                            <div class="sidebar" [class.open]="isSidebarOpen">
                                

                                <div class="styleforbutton">
                                    <button type="button" class="btn-close" aria-label="Close"
                                    (click)="isSidebarOpen = false"></button>
                                </div>

                                <p (click)="leftaerrow(i)"  >
                                    <svg   xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 100 100"
                                        class="btnforarrow">
                                        <circle cx="50" cy="50" r="45" stroke="blue" stroke-width="2" fill="none" />

                                        <path d="M60 35 L40 50 L60 65" stroke="blue" stroke-width="2" fill="none"
                                            stroke-linecap="round" stroke-linejoin="round" />
                                    </svg>
                                </p>

                                <p (click)="rightaerrow()" style="float:right;margin-top:-62px">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50"
                                        viewBox="0 0 100 100">
                                        <circle cx="50" cy="50" r="45" stroke="blue" stroke-width="2" fill="none" />

                                        <path d="M40 35 L60 50 L40 65" stroke="blue" stroke-width="2" fill="none"
                                            stroke-linecap="round" stroke-linejoin="round" />
                                    </svg>
                                </p>


                                <div class="main_container">
                                    <p style="margin: 0px;padding: 0px;font-size: 0.9rem;"><b> {{
                                            vehicleNumberfor_slider }}/{{ bikebrandfor_slider }}/{{ bikemodelfor_slider
                                            }}</b>
                                    </p>
                                    <div class="invstyle">
                                        <p><b>{{ invoiceNum }}/{{ invoiceDate | date:'dd MMM yyyy' }}</b></p>
                                        <div *ngIf="jobcard.invoice">
                                            <p><b>Inv Amount: ₹{{ invoiceAmount }}</b></p>
                                        </div>
                                        <div *ngIf="!jobcard.invoice && jobcard.estimate">
                                            <p><b>Est Amount: ₹{{ invoiceAmount }}</b></p>
                                        </div>
                                        <div *ngIf="!jobcard.invoice && !jobcard.estimate ">
                                            <p><b>Inv Amount: ₹{{ invoiceAmount }}</b></p>
                                        </div>

                                        
                                    </div>


                                    <div class="container">

                                        <div class="left">
                                            <h2 style="margin: 0;padding: 0;">Items:</h2>
                                            <div     style="max-height: 173px; overflow-y: scroll; border: 1px solid #ccc; margin-top: 10px;">

                                                <table>
                                                    <thead>
                                                        <tr>
                                                            <th style="margin: 0;padding: 0;">S.NO</th>
                                                            <th style="margin: 0;padding: 0;">Description</th>
                                                            <th style="margin: 0;padding: 0;">Amount</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr *ngFor="let data of carddata_fortable ; let i = index ">
                                                            <td style="margin: 0;padding: 0; ">{{i+1}}</td>
                                                            <td style="margin: 0;padding: 0;">{{data.spare}}</td>
                                                            <td style="margin: 0;padding: 0; ">{{data.amount}}</td>
                                                        </tr>
    
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                        <div class="right">
                                            <h2 style="margin: 0;padding: 0;">Complaints:</h2>
                                            <table>
                                                <thead>
                                                    <tr>
                                                        <th style="margin: 0;padding: 0;">S.NO</th>
                                                        <th style="margin: 0;padding: 0;">Description</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr *ngFor="let data of carddata_forcomplaints; let i = index">
                                                        <td style="margin: 0;padding: 0;">{{ i + 1 }}</td>
                                                        <td style="margin: 0;padding: 0;">
                                                            {{ getComplaint(data) }}
                                                        </td>
                                                    </tr>

                                                </tbody>
                                            </table>

                                            <h2 style="margin: 0;padding: 0;">Remarks:</h2>
                                            <div class="remarks">
                                                <p style="margin: 0;padding: 0;font-size: 0.9rem;">{{remarks}}</p>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
                </h3>
            </div>
        </div>
    </div>


    <div class="modal-body">
        <div class="vehicle-history-container">
            <div *ngIf="!vehcilehistorydata?.length" class="alert alert-warning">
                No vehicles available. Please add a new vehicle.
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <button class="btn btn-primary" (click)="addanother_vehicle()">Add Another Vehicle</button>
    </div>
</ng-template>




<ng-template #modelpage>
    <div class="modal-header">
        <h4 class="modal-title" id="modal-basic-title" style="color: grey;font-size: x-large ">Add Model</h4>
        <i (click)="addmodelpopup_close()" class="i-Close-Window" style="width: 25px;font-size:24px"></i>
    </div>
    <div class="modal-body">
        <form>
            <div class="form-group">
                <label for="picker1">Add Model</label>
                <input class="form-control" [(ngModel)]="addmodel">
                <span *ngIf="inventory_things" class="error-message"> already exists</span>
            </div>
        </form>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-primary btn-rounded" (click)="savemodel()">Save</button>
    </div>
</ng-template>

<ng-template #vehcilecolorpage>
    <div class="modal-header">
        <h4 class="modal-title" id="modal-basic-title" style="color: grey;font-size: x-large ">Add Colour</h4>
        <i (click)="addcolorpopupclosedialog()" class="i-Close-Window" style="width: 25px;font-size:24px"></i>
    </div>
    <div class="modal-body">
        <form>
            <div class="form-group">
                <label for="picker1">Add Colour</label>
                <input class="form-control" [(ngModel)]="addcolour">
                <!-- <span *ngIf="inventory_things" class="error-message"> already exists</span> -->
            </div>
        </form>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-primary btn-rounded" (click)="savevehiclecolours()">Save</button>
    </div>
</ng-template>