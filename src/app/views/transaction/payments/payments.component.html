

<!-- ui of aravind      -->

<!-- <div class="main-header"></div> -->
<h1 style="text-align: center"><strong>Supplier Payment</strong></h1>
<div class="row">
  
  <div class="container-fluid">
    <div class="row h-100">
      <!-- Left Side: Supplier Info and Selection -->
      <div class="col-lg-5 col-md-12 d-flex flex-column">
        <div class="card mb-5 flex-fill" style="margin-bottom: 48px">
          <div class="card-body">
            <h4>Supplier Selection</h4>
            <div class="d-flex flex-column">
              <!-- Supplier Select Field -->
              <div class="form-group">
                <label for="supplier-select" style="font-weight: bolder"
                  >Select Supplier:</label
                >
                <select
                  id="supplierselect"
                  (change)="onSelectionChange_payment($event)"
                  [(ngModel)]="selectedSupplier"
                  class="form-control"
                >
                  <option *ngFor="let item of allmasterdata" [value]="item">
                    {{ item.name }} ({{ item.type }} - {{ item.head }})
                  </option>
                </select>
              </div>

              <!-- Supplier Info Card Next to Supplier Select Field -->
              <div class="add" *ngIf="suppliercontainercard">
                <div style="font-size: smaller">
                  Address:&nbsp;{{ supaddress }}
                </div>
                <div style="font-size: smaller">Ph:&nbsp;{{ supmobile }}</div>
                <div style="font-size: smaller">GSTIN:&nbsp;{{ supgstno }}</div>
              </div>

              <!-- Date Input Field -->
              <div class="form-group mt-3">
                <label
                  for="dateInput"
                  class="col-form-label"
                  style="font-weight: bolder"
                  >Date</label
                >
                <input
                  type="date"
                  id="dateInput"
                  (click)="openCalendar($event)"
                  [(ngModel)]="todaysdate"
                  class="form-control"
                />
              </div>

              <!-- Radio Button Field for Payment Methods -->
              <label style="font-weight: bolder" class="mt-3"
                >Payment Method:</label
              >
              <div class="d-flex flex-column">
                <label class="radio radio-primary mb-2">
                  <input
                    type="radio"
                    id="bankOption"
                    name="paymentMethod"
                    (change)="selectPaymentMethod('Bank')"
                    value="bank"
                    [disabled]="!selectedSupplier"
                  />
                  <span>Bank</span>
                  <span class="checkmark"></span>
                </label>

                <label class="radio radio-primary mb-2">
                  <input
                    type="radio"
                    id="upiOption"
                    name="paymentMethod"
                    (change)="selectPaymentMethod('UPI')"
                    value="UPI"
                    [disabled]="!selectedSupplier"
                  />
                  <span>UPI</span>
                  <span class="checkmark"></span>
                </label>

                <label class="radio radio-primary mb-2">
                  <input
                    type="radio"
                    id="cashOption"
                    name="paymentMethod"
                    (change)="selectPaymentMethod('Cash')"
                    value="cash"
                    [disabled]="!selectedSupplier"
                  />
                  <span>Cash</span>
                  <span class="checkmark"></span>
                </label>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Right Side: Payment Sections -->
      <div class="col-lg-7 col-md-12 d-flex flex-column">
        <!-- Bank Payment Section -->
        <div
          class="card flex-fill"
          style="margin-bottom: 48px"
          *ngIf="bankpage"
        >
          <div class="card-body">
            <h4>Bank Payment</h4>
            <form class="d-flex flex-column">
              <div class="form-group row">
                <div class="col-md-6">
                  <label for="bank-select"><strong>Select Bank</strong></label>
                  <select
                    id="bank-select"
                    [(ngModel)]="selectedBank"
                    (change)="onBankChange(selectedBank)"
                    class="form-control"
                  >
                    <option *ngFor="let bank of banks" [ngValue]="bank">
                      {{ bank.bankname }} - {{ bank.accountnumber.slice(-4) }}
                    </option>
                  </select>
                </div>
                <!-- <div *ngIf="selectedBank" class="bank-card mt-3">
                  {{ bankcontainercard }}
                </div> -->

                <div class="col-md-6">
                  <label for="trans-date"><strong>Trans Date:</strong></label>
                  <input
                    type="date"
                    id="trans-date"
                    [(ngModel)]="paymentDate"
                    class="form-control"
                  />
                </div>
              </div>

              <!-- Other form groups -->
              <div class="form-group">
                <label for="amount"><strong>Amount:</strong></label>
                <input
                  type="text"
                  id="amount"
                  [(ngModel)]="paymentCash"
                  class="form-control"
                  style="text-align: right"
                />
              </div>
              <div class="form-group">
                <label for="trans-ref"><strong>Trans Ref:</strong></label>
                <input
                  type="text"
                  id="trans-ref"
                  [(ngModel)]="utrNumber"
                  class="form-control"
                />
              </div>
              <div class="form-group">
                <label for="particulars"><strong>Particulars: </strong></label>
                <textarea
                  id="particulars"
                  [(ngModel)]="particular"
                  class="form-control"
                ></textarea>
              </div>
              <button style="background-color: #5864ff;border:#5864ff;"
                class="btn btn-primary"
                id="savebtn"
                [disabled]="!utrNumber || !paymentCash || !particular"
                (click)="
                  proceedpayment(
                    bankpage,
                    paymentDate,
                    utrNumber,
                    paymentCash,
                    particular
                  )
                "
              >
                Save
              </button>
              <button style="margin-top: 5px; background-color: #5864ff;border:#5864ff;"
                class="btn btn-primary"
                id="savebtn"
                [disabled]="!utrNumber || !paymentCash || !particular"
                (click)="resetBank()"
              >
                Reset
              </button>
            </form>
          </div>
        </div>

        <!-- UPI Payment Section -->
        <div class="card flex-fill" style="margin-bottom: 48px" *ngIf="upipage">
          <div class="card-body">
            <h4>UPI Payment</h4>
            <form class="d-flex flex-column">
              <div class="form-group">
                <label for="trans-date-upi"><strong>Trans Date:</strong></label>
                <input
                  type="date"
                  id="trans-date-upi"
                  [(ngModel)]="paymentDate"
                  class="form-control"
                />
              </div>
              <div class="form-group">
                <label for="amount-upi"><strong>Amount:</strong></label>
                <input
                  type="text"
                  id="amount-upi"
                  [(ngModel)]="paymentCash"
                  class="form-control"
                  style="text-align: right"
                />
              </div>
              <div class="form-group">
                <label for="trans-id"><strong>Trans Id:</strong></label>
                <input
                  type="text"
                  id="trans-id"
                  [(ngModel)]="upiNumber"
                  class="form-control"
                />
              </div>
              <div class="form-group">
                <label for="particulars-upi"
                  ><strong>Particulars: </strong></label
                >
                <textarea
                  id="particulars-upi"
                  [(ngModel)]="particular"
                  class="form-control"
                ></textarea>
              </div>
              <button style="background-color: #5864ff;border:#5864ff;"
                class="btn btn-primary"
                id="savebtn"
                [disabled]="!upiNumber || !paymentCash || !particular"
                (click)="
                  proceedpayment(
                    upipage,
                    paymentDate,
                    upiNumber,
                    paymentCash,
                    particular
                  )
                "
              >
                Save
              </button>
              <button
                class="btn btn-primary" style="margin-top: 5px;background-color: #5864ff;border: #5864ff;"
                id="savebtn"
                [disabled]="!upiNumber || !paymentCash || !particular"
                (click)="resetUpi()"
              >
                Reset
              </button>
            </form>
          </div>
        </div>

        <!-- Cash Payment Section -->
        <div
          class="card flex-fill"
          style="margin-bottom: 48px"
          *ngIf="handcashpage"
        >
          <div class="card-body">
            <h4>Cash Payment</h4>
            <form class="d-flex flex-column">
              <div class="form-group">
                <label for="trans-date-cash"
                  ><strong>Trans Date:</strong></label
                >
                <input
                  type="date"
                  id="trans-date-cash"
                  [(ngModel)]="paymentDate"
                  class="form-control"
                />
              </div>
              <div class="form-group">
                <label for="amount-cash"><strong>Amount:</strong></label>
                <input
                  type="text"
                  id="amount-cash"
                  [(ngModel)]="paymentCash"
                  class="form-control"
                  style="text-align: right"
                />
              </div>
              <div class="form-group">
                <label for="particulars-cash"
                  ><strong>Particulars: </strong></label
                >
                <textarea
                  id="particulars-cash"
                  [(ngModel)]="particular"
                  class="form-control"
                ></textarea>
              </div>
              <button
                class="btn btn-primary"
                style="margin-top: 50px; background-color: #5864ff;border:#5864ff;"
                id="savebtn"
                [disabled]="!paymentCash || !particular || !paymentDate"
                (click)="
                  proceedpayment(
                    handcashpage,
                    paymentDate,
                    upiNumber,
                    paymentCash,
                    particular
                  )
                "
              >
                Save
              </button>
              <button
                class="btn btn-primary" style="margin-top: 5px; background-color: #5864ff;border:#5864ff;"
                id="savebtn"
                [disabled]="!paymentCash || !particular || !paymentDate"
                (click)="resetCash()"
              >
                Reset
              </button>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>

  

  <!-- Supplier Transactions Table -->
  <div *ngIf="suppliercontainercard">
    <table class="trans-table">
      <thead>
        <tr>
          <th style="width: 1px; text-align: center">Sl.No</th>
          <th style="width: 15%; text-align: center">Trans Date</th>
          <th style="width: 15%; text-align: center">Heads</th>
          <th style="width: 57%">Particulars</th>
          <th style="width: 11%; text-align: center">Receipt</th>
          <th style="width: 11%; text-align: center">Payment</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let data of sup_paymentdata.transaction; let i = index">
          <td style="text-align: center">{{ i + 1 }}</td>
          <td style="text-align: center">
            {{ data.receipttransaction.transaction_date | date : "dd-MM-yyyy" }}
          </td>
          <td style="text-align: center">
            {{ data.receipttransaction.expense_head }}
          </td>
          <td
            class="particulars-column"
            (click)="
              openparticularpopup(
                particularpage,
                data,
                sup_paymentdata.transaction,
                i,
                sup_paymentdata
              )
            "
            [attr.data-content]="
              getTruncatedText(
                data.receipttransaction.joinedparticulars ||
                  data.receipttransaction.particulars
              )
            "
          >
            {{
              getTruncatedText(
                data.receipttransaction.joinedparticulars ||
                  data.receipttransaction.particulars
              )
            }}
          </td>
          <td style="text-align: right">
            {{ data.receipttransaction.grand_total | number : "1.2-2" }}
          </td>
          <td style="text-align: right">
            {{ data.receipttransaction.payment | number : "1.2-2" }}
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <ng-template #particularpage>
    <div class="particulars-container">
      <h2 class="title"><strong>Particulars</strong></h2>
      <div class="details">
        <h4><b>Type:</b> {{ particularpopupdata_for }}</h4>
        <h4>
          <b>Date:</b> {{ particularpopupdata_transdate | date : "dd-MM-yyyy" }}
        </h4>
        <h4><b>Supplier:</b> {{ supname }}</h4>
        <h4><b>Amount:</b> {{ particularpopupdata_amount }}.00</h4>
        <h4><b>Trans Ref:</b> {{ particularpopupdata_transref }}</h4>
        <h4><b>Particulars:</b> {{ particularpopupdata }}</h4>
      </div>
      <div class="buttons">
        <button
          (click)="previousparticular()"
          type="button"
          class="btn btn-link btn-sm see-more-button"
        >
          Previous
        </button>
        <button
          (click)="nextparticular()"
          type="button"
          class="btn btn-link btn-sm see-more-button"
        >
          Next
        </button>
      </div>
    </div>
  </ng-template>
</div>
